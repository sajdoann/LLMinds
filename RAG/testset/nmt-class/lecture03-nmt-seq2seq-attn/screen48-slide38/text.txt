 For the computation of the derivatives afterwards, you just collect all the losses at each of the output words. At each of the words, at each of the positions, you get loss proportional to the negative logarithm of the probability of the word that should have been predicted. So this is easy to...